2025 10 23  



# SQL: DML

I'M COOKED.


## Inserting a row

```sql
(title, author, genre, category_id) values ('The Work nad the Glory', 'Gerald Lund', 'HistoricalFiction', 3);
```

If you don't give a value for one of the positions, it will be auto-filled with null. (Unless you defined the row as not null)

Last class (which I missed), we put a primary key (meaning it's always unique) called ID that auto increments. Becaues it auto increments, we don't have to worry ab writing it.

## Updating the table

```
UPDATE table
SET column = value, column = value, ...
WHERE condition
```

Example

```sql
UPDATE  member
SET name = 'Chris Jones',
    email_address = 'chris@gmail.com'
WHERE id = 3
```

The `WHERE` clause specifies which rows you want to update. It's kinda like an if statement that's checked before modifying a row. (It can be much more complicated than what we have here. SQL supports very complex (boolean) expressions here.)

### Set all email addresses to empty

```sql
UPDATE  member
SET email_address = ''
```

With no `WHERE` clause, every row in a table gets modified.


## Deleting table

```
DELE FROM table
WHERE condition
```

### Delete a member

```sql
DELETE FROM member
WHERE id = 3
```


### Delete all readings for a member

```sql
DELETE FROM books_read
WHERE member_id = 3
```

### Delete all books

```sql
DELETE FROM book
```

# Retrieving Data w/ SQL Queries

This is the kind of relational algebra stuff we went over in CS 236. (Woohoo!!!)

SQL Queries are a read (-only) operation. 

## SELECT

```
SELECT Column, Column, ...
FROM Table, Table, ...
WHERE Condition
```

The output of a select operation is a new table.

- The `SELECT` clause says which columns of data you want in the output.
- The `WHERE` clause says which rows of data you want in the output.
- The `FROM` clause says what tables to extract those columns from.

### Ex. 1: Selecting everything from a table

```sql
SELECT *
FROM book
```

Grabs everything from `book`. (i.e. produces an identical table.) Not super interesting, but useful.

### Ex. 2

```sql
SELECT author, title
FROM book
WHERE genre = "NonFiction"
```

The order you specify the columns in select query (in the `SELECT` clause) will be the order they appear in the outputted table.

### Ex. 3

```sql
SELECT id, name, parent_id
FROM category
WHERE parent_id = 1
```

### Ex. 4

```sql
SELECT member.name, book.title
FROM member, books_read, book
WHERE member.id = reading.member_id AND book.id = reading.book_id
```

Without the `WHERE` clause, it JOINS the tables (by Cartesian Product). It has all the columns from all the tables listed in the `FROM` clause. With the `WHERE` clause, it filters out the data into only the information we really want.

### Ex. 5

```sql
SELECT member.name, book.title
FROM member, books_read, book
WHERE member.id = books_read.member_id AND
    book.id = books_read.book_id AND
    genre = "NonFiction"
```

You can put whatever you want in a `WHERE` clause.

## JOIN

```sql
SELECT member.name, book.title
FROM member
INNER JOIN books_read ON member.id = books_read.member_id
INNER JOIN book ON books_read.book_id = book.id
WHERE genre = "NonFiction"
```

`INNER_JOIN` is Cartesian product.

There's also outer joins and left inner joins and right inner joins etc. etc. Roddieham said Wikipedia has a great article on all the different joins in SQL.

# Database Transactions

- By default, each SQL statement is executed in a transaction by itself.

Multi-statement transaction:

```
BEING TRANSACTION;
SQL statement 1;
SQL statement 2;
...
COMMIT TRANSACTION; or ROLLBACK TRANSACTION
```

Up until you commit the transaction, the changes you made to the database are not permanent.

- Transactions are useful when they consist of multiple SQL statements, since you want to make sure that either ALL of them or NONE of them succeed.

**Transactions are about safety.** If you don't use transactions, all the changes you make will be immediately permanent.

If SQL notices a transaction was cancelled midway through (e.g. booting it up after a power outage), it will rollback (undo) those changes.

# JDBC Overview

JDBC is used for using SQL in Java.

We're using mySQL for SQL. So we need a Java database driver for mySQL. We're using JDBC. The CS240 gods recomend `mysql-connector-j`.

## Using the database

1. Open a database connection (i.e. start a transaction)
   1. Note that unlike the example given in the slides, you wouldn't hard code your username and password into your Java code. Instead, you'd probs put it in a separate file that you don't include in your GitHub repo.
2. dkf; dskj faklsd f;adksf pasdif wepqif as

Imma be so fr I have NO effing clue what's going on I'm actually so cookked AAAHHHHGHGHGAHHHGHAGHAHGHAHAGHAGHAGHAGHAGHAGHAGHAGHAGHGJHUHYUFGIFAUYHFAAGDFYAHGSYUFIAEUYAFFDTFYUIF8UGHFASGDYGUWIETUWRHEAGFTYUHGSFFYUIGHGUTRGEFAYUIHDGFDUFHGFYSTYUIJHYUDFGHFYIAFHGFYFIUDOIHUGEIFUAHGQEWIHGFIOHEASGFIHOAGSHFGIDHBJHUGIHDFHOGGIHAAAEGWHOGHIODHGIFHO/